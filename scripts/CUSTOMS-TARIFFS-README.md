# 🛃 نظام التعريفات الجمركية - Customs Tariffs System

## 📋 نظرة عامة
تم إنشاء نظام شامل للتعريفات الجمركية يحتوي على **44 تعريفة جمركية** مختلفة تغطي جميع أنواع البضائع المستوردة.

## 🚀 التشغيل

### إضافة التعريفات الجمركية:
```bash
npm run db:seed-customs-tariffs
```

## 📊 التعريفات المضافة

### الفئات المتاحة:
- **إلكترونيات** (3 تعريفات)
- **ملابس ومنسوجات** (3 تعريفات)
- **مواد غذائية** (4 تعريفات)
- **أدوية ومستحضرات طبية** (2 تعريفات)
- **مستحضرات تجميل** (3 تعريفات)
- **قطع غيار سيارات** (3 تعريفات)
- **أثاث** (3 تعريفات)
- **أجهزة منزلية** (3 تعريفات)
- **مواد بناء** (3 تعريفات)
- **ألعاب** (2 تعريفات)
- **كتب** (1 تعريفة)
- **معدات رياضية** (2 تعريفات)
- **مجوهرات** (3 تعريفات)
- **أحذية** (2 تعريفات)
- **إكسسوارات** (1 تعريفة)
- **معدات مكتبية** (2 تعريفات)
- **معدات صناعية** (2 تعريفات)
- **تبغ** (1 تعريفة)
- **مشروبات** (1 تعريفة)

## 💰 أنواع الرسوم

### 1. **بضائع معفاة من الرسوم الجمركية (0%)**
- أجهزة كمبيوتر وهواتف ذكية
- مستحضرات صيدلانية وطبية
- كتب ومطبوعات
- طابعات وماسحات ضوئية
- آلات صناعية وزراعية

### 2. **بضائع برسوم عادية (5%)**
- معظم البضائع الاستهلاكية
- ملابس وأحذية
- أثاث وأجهزة منزلية
- مواد غذائية
- مستحضرات تجميل

### 3. **بضائع برسوم عالية**
- **سجائر**: 100% رسوم جمركية + 50 ريال رسوم إضافية
- **مشروبات شعير**: 50% رسوم جمركية + 25 ريال رسوم إضافية

## 📝 هيكل البيانات

كل تعريفة جمركية تحتوي على:
- **hsCode**: رمز النظام المنسق (HS Code)
- **description**: الوصف بالإنجليزية
- **descriptionAr**: الوصف بالعربية
- **dutyRate**: نسبة الرسوم الجمركية (%)
- **vatRate**: نسبة ضريبة القيمة المضافة (15% ثابت)
- **additionalFees**: رسوم إضافية (بالريال)
- **category**: فئة البضاعة
- **isActive**: حالة التفعيل

## 🔍 أمثلة على التعريفات

### إلكترونيات:
```javascript
{
  hsCode: '8471.30',
  description: 'Portable computers and tablets',
  descriptionAr: 'أجهزة كمبيوتر محمولة وأجهزة لوحية',
  dutyRate: 0,  // معفاة
  vatRate: 15,
  category: 'electronics'
}
```

### مواد غذائية:
```javascript
{
  hsCode: '0901.21',
  description: 'Roasted coffee',
  descriptionAr: 'قهوة محمصة',
  dutyRate: 5,
  vatRate: 15,
  category: 'food'
}
```

### بضائع محظورة/مقيدة:
```javascript
{
  hsCode: '2402.20',
  description: 'Cigarettes containing tobacco',
  descriptionAr: 'سجائر تحتوي على تبغ',
  dutyRate: 100,  // رسوم عالية جداً
  vatRate: 15,
  additionalFees: 50,
  category: 'tobacco'
}
```

## 💡 حساب الرسوم الجمركية

### المعادلة:
```
إجمالي الرسوم = قيمة البضاعة × (نسبة الرسوم الجمركية + نسبة الضريبة) + الرسوم الإضافية
```

### مثال عملي:
بضاعة بقيمة 1000 ريال، رسوم جمركية 5%، ضريبة 15%:
- الرسوم الجمركية: 1000 × 5% = 50 ريال
- الضريبة: 1000 × 15% = 150 ريال
- **الإجمالي**: 1000 + 50 + 150 = 1200 ريال

## 🔄 التحديث والصيانة

### إضافة تعريفة جديدة:
1. افتح ملف `scripts/seed-customs-tariffs.js`
2. أضف التعريفة الجديدة في مصفوفة `tariffs`
3. شغل السكريبت: `npm run db:seed-customs-tariffs`

### تعديل تعريفة موجودة:
```javascript
await prisma.customsTariff.update({
  where: { hsCode: '8471.30' },
  data: { dutyRate: 10 }
})
```

## 📈 الاستخدام في النظام

التعريفات الجمركية تُستخدم في:
1. **حساب رسوم التخليص الجمركي** عند إنشاء clearance
2. **إنشاء فواتير التخليص** تلقائياً
3. **عرض التفاصيل** للعملاء والمخلصين الجمركيين
4. **التقارير المالية** للمحاسبين

## ⚠️ ملاحظات مهمة

1. **الضريبة ثابتة**: جميع البضائع تخضع لضريبة 15% VAT
2. **الرسوم الإضافية**: تُطبق على بضائع محددة فقط
3. **التحديثات**: يجب تحديث التعريفات حسب القوانين الجديدة
4. **الفئات**: يمكن إضافة فئات جديدة حسب الحاجة

## 🛠️ استكشاف الأخطاء

### مشكلة: التعريفة موجودة بالفعل
```bash
⚠️ تخطي 8471.30 - قد يكون موجوداً بالفعل
```
**الحل**: احذف التعريفات القديمة أولاً أو استخدم update بدلاً من create

### مشكلة: خطأ في قاعدة البيانات
```bash
❌ خطأ في إنشاء التعريفات الجمركية
```
**الحل**: تأكد من اتصال قاعدة البيانات وصحة البيانات المدخلة

## 📞 الدعم

للمساعدة أو الاستفسارات:
- راجع ملف `prisma/schema.prisma` لفهم هيكل البيانات
- تحقق من logs السكريبت للحصول على تفاصيل الأخطاء
- تأكد من تشغيل migrations قبل إضافة البيانات
